#! /bin/bash
echo "***************************************************************************************************************************************************************************************************************";
DIA=`date +"%d/%m/%Y"`
HORA=`date +"%H:%M"`
ruta="/home/usuario/Escritorio/Cliente_PruebasConGit/PruebasConGitHub"
echo "Dia: $DIA Hora: $HORA"
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
cd  $ruta && pwd &&
git remote update &&
UPSTREAM=${1:-'@{u}'}
LOCAL=$(git rev-parse @)
REMOTE=$(git rev-parse "$UPSTREAM")
BASE=$(git merge-base @ "$UPSTREAM")

if [ $LOCAL = $REMOTE ]; then
    echo "SIN ACTUALIZACIONES"
elif [ $LOCAL = $BASE ]; then
git pull && 
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------"&&
/usr/local/bin/pm2 reload serv.js &&
echo "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------";
/usr/local/bin/pm2 l
else
echo "ERROR"
fi
echo "***************************************************************************************************************************************************************************************************************"

